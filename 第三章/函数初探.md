# 函数初探

## 前言

如果把《Z语言炼成记》比作一套大餐的话，那么前两章的内容算是开胃小菜。

第一章，Hello World，如题所示，只是打个招呼而已；最多算是搭好了工程架子，各位就做。
第二章，基本计算器，算是初步实现了编译器最基础的功能：词法分析、语法分析，以及各个后端，有了基本表达式的支持，算是一道可口的小菜。

从这一章开始，我们将深入编程语言的核心，讲述比较严肃的内容了。

编程语言的核心，有两个概念：**数据**与**操作**。程序的本质，就是对数据进行种种操作，并得到最终结果。

第一章所介绍的整数和字符串，就是最基本的**数据**类型，后面我们还会涉及更多的基本数据类型，以及更复杂的核心概念之一：**自定义类型**。

而第二章所讲的四则运算表达式，就是最基本的**操作**了。多个表达式的组合，就是**语句**，而一组语句拼起来，再加上对输入的数据（即**参数**）和输出的结果（即**返回值**）的说明，合起来就叫做**函数**。

由于函数本身就带有输入数据和输出结果的说明，又包含了具体操作的实现，所以可以说**函数**是编程语言中最核心的概念。

按照由浅入深的原则，一般来说，编程语言的书籍都会按照抽象度从低到高的顺序来介绍语言特性：

1. 基本数据（例如整数）
1. 变量（基本数据的代名词）
1. 表达式（操作基本数据的方式）
1. 语句（如if-else等，可以组合表达式）
1. 函数（语句与表达式的组合）
1. 类型（数据与行为的组合；类型的方法其实就是一种特殊的函数）
1. 泛型（更加抽象的类型）
1. 模块（相似功能的数据与行为打个包）
1. 库（一组模块的集合）

前面的第一章和第二章基本是按照这个逻辑来介绍的。

按照这个顺序，第三章应该介绍变量或者语句了。原先我也是这么规划的。

那么为什么真来写的时候，我把函数的探讨提前了呢？

## 为什么先讨论函数

其实我们在第一章已经见过最简单的函数：`print`了。

那为什么要单独拿出一整章来讲函数呢？而且是这么早？

因为它值得。

上面已经说了，函数是编程语言里最核心的概念，这是原因之一。
但这也不是提前介绍的原因啊，因为组成函数的基本单位：变量和语句，我们还没讲呢。

我要提前介绍函数，再回过头来讲变量和语句，
最主要的原因，在于函数的**实用性**。

我们学习编程，是拿来用的。
我设计Z语言，也是拿来用的。
这是本书的基本宗旨。

所以回头一看，前两章虽然涉及了很多东西，但若说实用，其实只做了两件简单的事情：

- 在命令行打印一条消息
- 进行简单的四则运算

这够吗？这不够。

即使作为开胃小菜，它们的味道也太寡淡了。

既然本章起要进入正餐流程了，那么第一道主菜，一定是要有味道的！

对于编程语言来说，什么叫能看得见闻得着的味道？那就是**应用**。

我们需要能真正肉眼看到的，跑起来的应用，最好是图形化的。

只有变量和语句，能做到这一点吗？能画出图来吗？能打开窗口吗？能写下文件吗？能跑起小人吗？能生成AI图吗？
都不能。

那谁才能做到这一点呢？非**函数**莫属。

函数是编程语言的积木块，是各种程序系统沟通的基本单位：

- 要和操作系统进行沟通，必须要掌握“系统调用”，即操作系统提供的一组关键函数。
- 标准库的核心，也是各个库的函数。我们称之为“函数接口”。
- 跨系统之间的沟通，都是通过“API”来表达的，而API就是一组函数。
- 任何WEB或app界面，用户的每一次点击，实际上都是远程（通过HTTP协议）调用了一个函数。
- AI的神经网络，本质上也是一个巨大的函数。

总之，函数是程序的基本工具，是所谓“语言生态”的基本单元。

即使现在没有变量、没有语句，但我们如果有了最基本的函数，也能通过`调用`的方式，借用系统库，或者Python和JS的库，来实现相对复杂的功能了。

这样，Z语言就能尽早“实用”起来。

本章我们要做到的“应用”点，初步规划了这几个：

1. REPL：调用系统命令，模拟bash/cmd的基本操作（例如`ls`、`cd`、`mkdir`、`rm`等）。
1. GUI：通过调用系统库，打开一个窗口，并显示一点内容。
1. 文件I/O：调用C标准库，读写文件。
1. 图表：调用Python的画图库，画出一个柱状图。
1. 三角形：调用JS的Canvas库，画出一个三角形。

这5个认为，分别对应了Z的5个应用场景：解释器（REPL）、编译器、C、Python和JS。

我们现在手头只有几个工具：

- 整数
- 常量字符串
- 最基本的函数（还需要在本章实现）

这样水平的工具在Z语言之内暂时还做不了什么有用的事情，不过借助函数去调用外部的生态，正是Z语言特色的一个良好的展示。

本节，我们先探讨一下要做到上述的事情，我们需要哪些关于函数的概念。

## 函数的基本组成


